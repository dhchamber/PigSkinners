{% extends 'appmain/base.html' %}
{% load static %}
{% load template_filter %}
{% load tz %}
{% block title %}{{ request.user.first_name }}, Welcome to the Football Pool!{% endblock title %}
{% block stylesheet %}
    <link rel="stylesheet" type="text/css" href="{% static 'css/home.css' %}?version=3"/>
{% endblock stylesheet %}

{% block content %}
    {% if user.is_authenticated %}
		<div class="container">
        </div>
    {% else %}
      <p>You are not logged in</p>
      <a href="{% url 'login' %}">login</a>
    {% endif %}

<!--    <body leftmargin="0" topmargin="0" marginheight="0" marginwidth="0" LANGUAGE="javascript" onload="return window_onload()">-->
        {% get_current_timezone as TIMEZONE %}
        <table cellpadding="0" cellspacing="0" border="0" width="100%" class="home_content" id="tblContent" name="tblContent">
                    <tr>
                        <td width="15px">&nbsp;</td>
                        <td align="center">
                            <table cellpadding="0" cellspacing="0" border="0" bgcolor="white" width="100%">
                                <tr>
                                    <td colspan=3 align=center>Welcome {{request.user.first_name }} {{request.user.last_name }}</td>
                                </tr>
                                <tr>
                                    <td width="30%" align="center" valign="top">
                                        <a href='http://www.stlouisrams.com/'><img border='0' src="{% static '/appmain/Helmets/small/v_stl.jpg' %}" height='72px'></a>
                                        <br><br>
                                        <font size="+2"><b>
                                        {% if week.gt == 'POST' %}
                                            Playoff time!
                                        {% elif week.gt == 'PRE' %}
                                            Current Week:<br>PreSeason Week: {{ week.week_no }}
                                        {% elif week.gt == 'REG' %}
                                            Current Week:<br>Regular Season Week: {{ week.week_no }}
                                        {% endif %}
                                        </b></font>
                                        <br><br>
                                        <font size="+1">Pick Status: </font>
                                        {% if week.closed %}
                                            <font size="+2" color="red"><b>CLOSED</b></font>
                                        {% else %}
                                            <font size="+2" color="blue"><b>OPEN</b></font><br>
                                            <font size="+2" color="blue"><b>Picks will Close: {{ week.forecast_dt_closed }}</b></font>
                                        {% endif %}
                                    </td>
                                    <td width="40%" align="center">
                                        <font size=-1>All times are in {{ TIMEZONE }}</font>
                                        <br>
                                        <img class="imgLogo" id="imgLogo" name="imgLogo" src="{% static '/appmain/Logo/Pigskinners_logo.gif' %}" WIDTH="367" HEIGHT="196">
                                        <br>
                                        <!--this is to make sure the gif is downloaded by the time we need it-->
                                        <img id="hidExplode" name="hidExplode" width="0px" src="{% static '/appmain/HomePage/explosion.gif' %}" style="visibility:hidden">
                                    </td>
                                    <td width="30%" align="center" valign="top">
                                        <a href='http://www.stlouisrams.com/'><img border='0' src="{% static '/appmain/Helmets/small/h_stl.jpg' %}" height='72px'></a>
                                        <br>
                                        <br>&nbsp;
                                        <div id="countdown" style="visibility: hidden">
                                            <table cellpadding="0" cellspacing="0" class="countdown_clock_newyears">
                                                <tr>
                                                    <td colspan="3">&nbsp;</td>
                                                </tr>
                                                <tr>
                                                    <td width="5px">&nbsp;</td>
                                                    <td><img id="counter_day1" /><img id="counter_day2" /><img id="counter_divider1" src="{% static '/appmain/counter/dgc.gif' %}" /><img id="counter_hour1" /><img id="counter_hour2" /><img id="counter_divider2" src="{% static '/appmain/counter/dgc.gif' %}" /><img id="counter_minute1" /><img id="counter_minute2" /><img id="counter_divider3" src="{% static '/appmain/counter/dgc.gif' %}" /><img id="counter_second1" /><img id="counter_second2" /></td>
                                                    <td width="5px">&nbsp;</td>
                                                </tr>
                                                <tr>
                                                    <td colspan="3">&nbsp;</td>
                                                </tr>
                                            </table>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan=3 align=center>
                                        <br>
                                        <br><a href='Standings_Post.asp'><font size='+2' color='darkgreen'>Click here to see the Postseason Standings!</font></a></td>
                                </tr>
                            </table>
                        </td>
                    </tr>
        </table>
     <div class="col-md-6 col-sm-6 col-xs-12">
        <div class="row">
           <div class="full">
              <div class="right-match-time">
                 <h2>Close Countdown</h2>
                    <span id="days">Days</span> <span id="hours">Hours</span>
                    <span id="minutes">Minutes</span>
                    <span id="seconds">Seconds</span>
                 </ul>
              </div>
           </div>
        </div>
     </div>

        <!--these are all divs used for the "helmet crashing"-->
        <div id="divExplode" name="divExplode" STYLE="position:absolute;top:100px;left:400px;visibility:hidden;">
            <img src id="imgExplode" name="imgExplode" loop="1" width="95px">
        </div>
        <div id="divVisitorHelmet" name="divVisitorHelmet" STYLE="position:absolute;top:450px;left:300px;visibility:hidden;">
            <table border="0" cellspacing="0" cellpadding="0">
                <tr>
                    <td>
                        <img src="" alt border="0" onclick="javascript: playGraphics();">
                    </td>
                </tr>
            </table>
        </div>

        <div id="divPointsGameText" name="divPointsGameText" STYLE="-moz-opacity:1%;filter:alpha(opacity=1)">
<!--visibility:hidden;            -->
            <table border="0" cellspacing="0" cellpadding="2" width="100%" class="tblPointsGame">
                <tr>
                    <td align="center">
                        This Week's Points Game: {{ week|ptsgame }}
                    </td>
                </tr>
                <tr>
                    <td align="center"><font size="+1"><b></b></font></td>
                </tr>
                <tr>
                    <td align="center"></td>
                </tr>
            </table>
        </div>

        <div id="divHomeHelmet" name="divHomeHelment" STYLE="position:absolute;top:450px;left:812px;visibility:hidden;">
            <table border="0" cellspacing="0" cellpadding="0">
                <tr>
                    <td>
                        <img src="" alt border="0" onclick="javascript: playGraphics();">
                    </td>
                </tr>
            </table>
        </div>

<!--    </body>-->
<script>
function makeTimer() {
   var endTime=new Date({{ week.forecast_dt_closed|date:"U" }} * 1000);
    endTime = (Date.parse(endTime) / 1000);

        var now = new Date();
        now = (Date.parse(now) / 1000);

        var timeLeft = endTime - now;

        var days = Math.floor(timeLeft / 86400);
        var hours = Math.floor((timeLeft - (days * 86400)) / 3600);
        var minutes = Math.floor((timeLeft - (days * 86400) - (hours * 3600 )) / 60);
        var seconds = Math.floor((timeLeft - (days * 86400) - (hours * 3600) - (minutes * 60)));

        if (hours < "10") { hours = "0" + hours; }
        if (minutes < "10") { minutes = "0" + minutes; }
        if (seconds < "10") { seconds = "0" + seconds; }

        $("#days").html(days + "<span> Days</span>");
        $("#hours").html(hours + "<span> Hours</span>");
        $("#minutes").html(minutes + "<span> Minutes</span>");
        $("#seconds").html(seconds + "<span> Seconds</span>");

}

setInterval(function() { makeTimer(); }, 1000);
</script>
{% endblock %}